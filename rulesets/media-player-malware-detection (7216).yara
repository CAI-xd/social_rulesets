/*
    Koodous Community Public Rule. Create your own rules to detect malware 
    for android at: https://koodous.com/
    
    Author: Longc8
    Rule name: Media Player Malware Detection
    Rule id: 7216
    Created at: 2020-11-09 20:29:24
    Updated at: 2020-11-09 20:52:25
    
    Rating: #0
    Total detections: 0
*/

import "androguard"
import "file"
import "cuckoo"

rule koodous : official
{
	meta:
		name = "Olav Witvliet, Long Long Chen"
		Studentnumber = "s2642964, s2403846"
		description = "This rule detects the malicious apk called Media Player by searching for suspicious strings and conditions"
		sample = "d79e71c4801b90d68cfcc7c913148151b31b3f79612b748ccfd5ed51257e9834"

	strings:
		$a = "http://drius.aefrant.com/"

	condition:
		androguard.package_name("air.com.KalromSystems.VoiceDrawFree") and
		androguard.app_name("Media Player") and
		androguard.permission(/android.permission.ACCESS_COARSE_LOCATION/) and
		androguard.permission(/android.permission.INTERNET/) and
		androguard.permission(/android.permission.WRITE_EXTERNAL_STORAGE/) and
		$a
}
