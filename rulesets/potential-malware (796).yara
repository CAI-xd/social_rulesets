/*
    Koodous Community Public Rule. Create your own rules to detect malware 
    for android at: https://koodous.com/
    
    Author: ldelosieres
    Rule name: Potential malware
    Rule id: 796
    Created at: 2015-08-25 19:11:32
    Updated at: 2015-10-08 20:38:50
    
    Rating: #1
    Total detections: 28097
*/

import "androguard"
import "droidbox"

rule potential_malware
{
	meta:
		description = "Potential malware"

	strings:
		$a = "com.example.smsmessaging.TestService"
		$b = "setComponentEnabledSetting"

	condition:
		androguard.permission(/BOOT_COMPLETED/) and
		androguard.permission(/CHANGE_COMPONENT_ENABLED_STATE/) and
		$a and $b
}

/*rule ProcessKiller
{
	meta:
		description = "Process killer"
		
	condition:
		androguard.permission(/android.permission.KILL_BACKGROUND_PROCESSES/)
}*/

rule RootApp
{
	meta:
		description = "Root app"
		
	strings:
		$a = "ROOT_ERROR_FAILED"
		$b = "STEP_EXECUTE"
	
	condition:
		all of them
}
