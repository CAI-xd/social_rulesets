/*
    Koodous Community Public Rule. Create your own rules to detect malware 
    for android at: https://koodous.com/
    
    Author: mertcangokgoz
    Rule name: Anubis malware variant detection
    Rule id: 6884
    Created at: 2020-04-30 14:33:34
    Updated at: 2020-04-30 17:42:55
    
    Rating: #1
    Total detections: 0
*/

import "androguard"
import "file"

rule Anubis_Variant : BankBot
{
	meta:
        description = "Anubis malware targeting banks"
		source = ""
	
	strings:
		$c2_1 = "/o1o/a6.php" nocase
		$c2_2 = "/o1o/a14.php" nocase
		$c2_3 = "/o1o/a3.php" nocase
		
	condition:
		2 of ($c2_*)
		and (
			androguard.permission(/android.permission.RECEIVE_SMS/) 
			or androguard.permission(/android.permission.READ_SMS/)
			or androguard.permission(/android.permission.SEND_SMS/)
		)
}
