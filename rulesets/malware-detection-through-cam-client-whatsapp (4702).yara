/*
    Koodous Community Public Rule. Create your own rules to detect malware 
    for android at: https://koodous.com/
    
    Author: juangrajales8422
    Rule name: Malware detection through CAM Client WhatsApp
    Rule id: 4702
    Created at: 2018-07-29 01:48:10
    Updated at: 2018-07-29 01:48:23
    
    Rating: #0
    Total detections: 744541
*/

import "androguard"
import "file"
import "math"
rule CAM_28_07_2018_05_46_19_WhatsApp
{
meta:
description = "Malware detection through CAM Client"
condition:
androguard.package_name("com.whatsapp") and
androguard.app_name("WhatsApp")
and(
androguard.permission(/android.permission.SET_WALLPAPER/) or
androguard.permission(/android.permission.READ_SMS/) or
androguard.permission(/android.permission.READ_CALL_LOG/) or
androguard.permission(/android.permission.CALL_PHONE/) or
androguard.permission(/android.permission.WRITE_SETTINGS/) or
androguard.permission(/android.permission.WRITE_CALL_LOG/))
or not androguard.certificate.sha1("38A0F7D505FE18FEC64FBF343ECAAAF310DBD799")
or not file.md5("556c6019249bbc0cab70495178d3a9d1")
}
