/*
    Koodous Community Public Rule. Create your own rules to detect malware 
    for android at: https://koodous.com/
    
    Author: zyrik
    Rule name: mnrs_only_strings
    Rule id: 5261
    Created at: 2019-02-08 15:00:56
    Updated at: 2019-02-08 15:03:44
    
    Rating: #0
    Total detections: 1027
*/

import "androguard"
import "file"
import "cuckoo"


rule potential_miners_by_strings : miner 
{
	meta:
		description = "This rule detects potential miners using only strings"
		author = "https://koodous.com/analysts/zyrik"

	strings:
        $id001 = "4Cf2TfMKhCgJ2vsM3HeBUnYe52tXrvv8X1ajjuQEMUQ8iU8kvUzCSsCEacxFhEmeb2JgPpQ5chdyw3UiTfUgapJBhBKu2R58FcyCP2RKyq"
        $id002 = "44V8ww9soyFfrivJDfcgmT2gXCFPQDyLFXyS7mEo2xTSaf7NFXAL9usGxrko3aKauBGcwZaF1duCWc2p9eDNt9H7Q8iB7gy"
        $id003 = "43QGgipcHvNLBX3nunZLwVQpF6VbobmGcQKzXzQ5xMfJgzfRBzfXcJHX1tUHcKPm9bcjubrzKqTm69JbQSL4B3f6E3mNCbU"
        $id004 = "45vSqhWgnyRKKjmiUsSpnd14UZpMoVgZWARvyepZY1fEdERMnG6gyzB8ziGB5fCg9cfoKywXdgvXVg1E9bxzPbc8CSE5huQ"
        $id005 = "46yzCCD3Mza9tRj7aqPSaxVbbePtuAeKzf8Ky2eRtcXGcEgCg1iTBio6N4sPmznfgGEUGDoBz5CLxZ2XPTyZu1yoCAG7zt6"
        $id006 = "422QQNhnhX8hmMEkF3TWePWSvKm6DiV7sS3Za2dXrynsJ1w8U6AzwjEdnewdhmP3CDaqvaS6BjEjGMK9mnumtufvLmz5HJi"
        $id007 = "42DEobaAFK67GTxX359z83ecfa2imuqgRdrdhDRo4qGnXU6WijcjmHfQoucNPxQaZjgkkG5DWkahi8QnsXKgapfhRHo4xud"
        $id008 = "43FeFPuaspxAEU7ZGEY93YBmG8nkA1x1Pgg5kTh7mYuLXCzMP3hERey6QBdKKBciuqhsakJD44bGHhJX98V3VjbZ9r1LKzx"
        $id009 = "45oLJdzMCfPFrtz46yqNNyTNKPFRvye5XB94R7sDWvZQZmoyPy6pfk9fdgJaXFs5Jp7F8R8V42UoxjXKE2Ze842Q18Lx24G"
        $id010 = "44yphkVFNewhMGi8LkgfYSSo4gbpnT7uPeGdtwvACMB6S4zY2B6D3iWY9yF7mFX6rbJ3A3fCd8cqJVbW2zYEJLLGEnYfhLy"
        $id011 = "49Bq2bFsvJFAe11SgAZQZjZRn6rE2CXHz4tkoomgx4pZhkJVSUmUHT4ixRWdGX8z2cgJeftiyTEK1U1DW7mEZS8E4dF5hkn"
        $id012 = "4ASDBruxfJ4in134jDC1ysNPjXase7sQwZZfnLCdyVggfsaJB1AxSA8jVnXwLEe1vjBhG7sfpssqMZ8YCSAkuFCELvhUaQ1"
        $id013 = "Q0105005d36e565f5487c1d950e59a04c05c4f410345d460d8bd4d59ca2428fe7b69cf6b787fa92"
        $id014 = "44ea2ae6ec816e7955d27bf6af2f7c2e6ce36c142ee34e428dbcc808af9bc078"
        $id015 = "515b125d8a9fbc944f8652841869335d21fb0a2968c3"
        $id016 = "RHDMXKDoD2aYDwX5PRM0IUfNrQMv9yCR"
        $id017 = "1eUqLvDauJzZUjLlxvEBJfaMXpcCvOum"
        $id018 = "OkcKKX6waOTc0sRFwJXdh5PFTobpRMow"
        $id019 = "6GlWvU4BbBgzJ3wzL3mkJEVazCxxIHjF"
        $id020 = "8LqXh2UY7QzxwK2PrIQLn3iwd7HfuYgt"
        $id021 = "BLAXcU2ALlc06bhhl4Dj64Wbj44hnKYO"
        $id022 = "bLXRob0Mov5Po9c0fSrXexaJkciBo5Dp"
        $id023 = "E2B9t9yVqR62YaRw4wWX3jfadGdxcRfH"
        $id024 = "esp9hnZ3rOao2IadnClF11r6PWtExGAB"
        $id025 = "f4JsDABslmUsqfqa1SqBxbdUFp9h8eAe"
        $id026 = "InSicsHzpAQpeRBTvV2bCRT3J5mK8IoH"
        $id027 = "ITERXYJEQszTERbPanh7CxXanvT64Q5C"
        $id028 = "N09gjytzJzCQzFy9MRuchpT6TzqMXjVB"
        $id029 = "nS4VZBZRmBGNvzfQN57Mu4aodai7Hh9U"
        $id030 = "o2nnEz8ECFPcZvqSInL1Z1xcbyYvpqzD"
        $id031 = "pRdnpY8EOPrnZdDDqYStGOTLNborIkCY"
        $id032 = "tx82bQv1RTVR5V0fe2hUMSkmyNw9zmlS"
        $id033 = "v2RuDMli7TYzHF7ge0lG5VLYUDp5ISM3"
        $id034 = "W9e1JbsYTHqCwImFfAEGfJJigBCWfYv2"
        $id035 = "Xo54zUaiQUexHS1nEkT6b038trLnt0vg"
        $id036 = "XxTxffZJjxU8rLviOim34l5O3MJMWmDK"
        $id037 = "uBiTW6jSZk7mqG4mJRq4TeHMYhwu96it"
        $id038 = "aePxi6MAxNjx4Zrza5XpYaETxzCiCAGD"
        $id039 = "ZjWTajjTeo0IFi1lE3ArPpJ9MCnsimm7"
        $id040 = "pfSLncN8wTEksroVnGo5qE2rlc0zPsu4"
        $id041 = "p3ghDUhs89AhpWiQqh01aBbSFO9BQfR6"
        $id042 = "qqWrKdZTVrXznFYcZ1icdXh3mjROzyhQ"
        $id043 = "ejYytKXlz2qRKYxsHp7yeqPyEF93sMOx"
        $id044 = "VOTOnyFz4gLoYQokkyZ0O2C67UgejX14"
        $id045 = "HtQkBqXwvzRHUdngvFWg1j84fQ62RnVo"
        $id046 = "cJsrc2H0m8rKjzXo4CF7cPLcg6znPogR"
        $id047 = "lRzS5W2NgHybxcbH5BHNnNat4QajQy51"
        $id048 = "9eJhVNC0dT3qgLWnnz0ojYkBJWDZONpO"
        $id049 = "JTGErE8qg0xjlgI8aJckAqX7uamxBCyb"
        $id050 = "ciIJoDEHvWDsFjUHfX7nDMuADREcBMjD"
        $id051 = "ivFo3gzNufGSFc4lAS7dbQecVnEwf2fn"
        $id052 = "nUNBYr6kljQAEVkfLgxRY2UavY6okT4y"
        $id053 = "rD0u5dQUdYEhyHzdUt4b4HFj5OnQfylx"
        $id054 = "sdibwtwKsYZue7Q7yCoKPy7ZwIeweQXw"
        $id055 = "CxHsGJiU1DItubcIa6r7T8bK27a4eUZG"
        $id056 = "NPYVnbZeXgvboqWU0pzUVasryJgShjMU"
        $id057 = "6VLUnZXGvLqDuABUvERNwKObgOPDnB2j"
        $id058 = "YQ1at78RnEjeEiIRzLGAGY9lFo4iHU8v"
        $id059 = "4O99dpG3I4wBLhRLutkoA2cIAkWxqiZl"
        $id060 = "DulPovFs1oAWloQEruJIMlBpsDooMI1f"
        $id061 = "nYt8fRXPWp92u8MHvtdNVOoyuYdfZIdd"
        $id062 = "fwW95bBFO91OKUsz1VhlMEQwxmDBz7XE"
        $id063 = "8SUFoIbdMUfwgDVAXgyyaC5R1k1B2ny1"
        $id064 = "1a0Cej64dYffEiItrLIeiq4GfpPtn0Hf"
        $id065 = "pnkGf8QJ92Z7QEhw8exumIL8HjKCBveQ"
        $id066 = "EjGZOcQjjaAU6sPmgtoUtgfxJSzAI7Id"
        $id067 = "3ARWsJFCmo3Kg13cnr4BAW3fP5uLLoMsbL"
        $id068 = "jPypuxLViIH1ZNallVeg9LqypsYK0wq9"
        $id069 = "ugrZV7MvW9J6Wfa1NgE7qwXFmTHhYorj"
        $id070 = "aX3rvYs5vmuTbT0rr83UDiUD0VolYCkZ"
        $id071 = "1DLnwEX2GUhmRA62aCMAveHPzUN9m2dd"
        $id072 = "8P3iejGFCkXynNojWYArCRBZ21J6zrDy"
        $id073 = "y7cM7qd7ZEEQ6MdkCtDdwo6EcOpe6Oyu"
        $id074 = "dsQIV8MsvvWHB1Q8Ky1faRlpU0qzYVg1"
        $id075 = "fljRO8IOscGvuIX6I2N6agxzVM9XoYXt"
        $id076 = "1a0Cej64dYffEiItrLIeiq4GfpPtn0Hf"
        $id077 = "dzZiMNu2ju00u997BHk2uk6n6GKbtuXw"
        $id078 = "OE4oIwyeXe5YImXY5lDLscoZZrhm9DDN"
        $id079 = "eKoOYNLHEMxcmFXrQnARORLeZo9SMlZR"
        $id080 = "aePxi6MAxNjx4Zrza5XpYaETxzCiCAGD"
        $id081 = "HN0DRyXrOpCbdkyWIZnC7UjMeXvFtkh0"
        $id082 = "1nK3FmVEeZ0bjc6Np1r63wkynuTP3oqU"
        $id083 = "aePxi6MAxNjx4Zrza5XpYaETxzCiCAGD"
        $id084 = "c0aYHt9KgnXUpmZkm7tGPW2rGXl2bM2d"
        $id085 = "bXjy6ex2L7E4nI7RATUXKQKlRVeY8pyw"
        $id086 = "ZPKnEehMXNylSyz6HFP7xBUlCADEIcPy"
        $id087 = "fqJfdzGDvfwbedsKSUGty3VZ9taXxMVw"
        $id088 = "PT13WGgxMmJoaEdMc3dDTDE5Mlp2TjNY"
        $id089 = "Jz0IWB14EmMzZDdMc3dDdnZ4R2tsaDI9"
        $id090 = "PEDk4i0UIq7GsUEAEwXs31dqKjDHUI3z"
        $id091 = "FYEAbFBG3xY5VUtE9GXC56v5UKt4xkoUkb"
        $id092 = "2HujvzmUo2nuRLLqhIHIV4sCEmRw9FIc"
        $id093 = "5xUKpsv5UFOcqf6dToqMDAtBYKn1WavS"
        $id094 = "9AYxnHCZ2H7MwagCSMDwLiSizaSbqhSp"
        $id095 = "qpzry9x8gf2tvdw0s3jn54khce6mua7l"
        $id096 = "anWcowZ0OspSk7SPFH0itFrDrNyCpVXp"
        $id097 = "cLfiFmhE82tUfGodiYgS3U1ewQpMa2nc"
        $id098 = "DUMWz54MXfCcQGUufjx7aeBlGgaurUcU"
        $id099 = "dWzYVbhggge684eSOBSvN7gEoGs9Mjc"
        $id100 = "fz0unvRkvThZ7DcPzxfMnZoTEpZJoblt"
        $id101 = "JCchrP65tMKei1yeLQGtaOdZxXtxZryy"
        $id103 = "o2iHliDUYieOuXz3wME2NjZW79a5apK5"
        $id104 = "oQtjTDL7Jzpj8yTCD8RJMN3cxLt3pXUD"
        $id105 = "QnXbx7vLFIUq9FT0kfNZSjBkUD0GCcqi"
        $id106 = "ZHg7IgsgCYIQLhWEnLVFq06yKedNkKC9"
        $id107 = "eXnvyAQwXxGV80C4fGuiRiDZiDpDaSrf"
        $id108 = "1NeoArmnGyWHKfbje9JNWqw3tquMY7jHCw"
        $id109 = "LA7Ida655adggnBNrMgKfj7ufCwUSBQwZb7"



        $js001 = "minercry.pt/processor.js"
        $js002 = "lib/crypta.js"
        $js003 = "authedmine.com/lib/authedmine.min.js"
        $js004 = "coin-hive.com/lib/coinhive.min.js"
        $js005 = "coinhive.com/media/miner.htm"
        $js006 = "coinhive.com/lib/coinhive.min.js"
        $js007 = "cryptaloot.pro/lib/crypta.js"
        $js008 = "webminerpool.com/miner.js"
        $js009 = "play.gramombird.com/app.js"
        $js010 = "CoinHive.User("
        $js011 = "CoinHive.Anonymous("
        $js012 = "CoinHive.Token("
        $js013 = "CoinHive"
        $js015 = "miner.start("
        $js016 = "coinhive_site_key"
        $js017 = "MinerPage.prototype.startStopMine("
        $js018 = "Android.onMiningStartedJS()"
        $js019 = "javascript:startminer("
        $js020 = "javascript:startMining()"
        $js021 = "javascript:stopMining()"
        $js022 = "CRLT.Anonymous("
        $js023 = "CoinImp.Anonymous("
        $js024 = "Client.Anonymous("
        $js025 = "NFMiner"
        $js026 = "deepMiner.Anonymous"


        $lib001 = "libminer.so"
        $lib002 = "libcpuminer.so"
        $lib004 = "libcpuminer-neon.so"
        $lib005 = "libneondetect.so"
        $lib006 = "libjpegso.so"
        $lib007 = "libcpuminerneonpie.so"
        $lib008 = "libcpuminerneon.so"
        $lib009 = "libcpuminerpie.so"
        $lib010 = "libcpuminerx86.so"
        $lib011 = "libMINERWRAPPER.so"
        $lib012 = "libCPUCHECKER.so"
        $lib013 = "minerd"
        $lib014 = "minerd_neon"
        $lib015 = "minerd_regular"
        $lib016 = "libgl-render.so"
        $lib017 = "libminersdk-neondetect.so"
        $lib018 = "libminersdk-x86.so"
        $lib019 = "libminersdk.so"


        $api001 = "Lcom/kaching/kingforaday/service/CoinHiveIntentService"
        $api002 = "Lcom/theah64/coinhive/CoinHive"
        $api004 = "Lcom/bing/crymore/ch/model/GlobalConfig"
        $api005 = "Ler/upgrad/jio/jioupgrader/Coinhive"
        $api006 = "Lcom/mobeleader/spsapp/Fragment_Miner"
        $api007 = "Lcom/mobeleader/spsapp/SpsApp"
        $api008 = "Lcom/mobeleader/minerlib/MinerLib"
        $api009 = "Lcom/coinhiveminer/CoinHive"
        $api011 = "Lclub/mymedia/mobileminer/modules/mining/coinhive/CoinHive"
        $api012 = "Lclub/mymedia/mobileminer/modules/mining/coinhive/MoneroMiner"
        $api013 = "Lclub/mymedia/mobileminer/mining/coinhive/MoneroMiner"
        $api014 = "Lclub/mymedia/mobileminer/mining/litecoin/LiteCoinMiner"
        $api015 = "Lclub/mymedia/mobileminer/modules/mining/coinhive/CoinHive"
        $api016 = "Lclub/mymedia/mobileminer/modules/mining/coinhive/MoneroMiner"
        $api017 = "Lclub/mymedia/mobileminer/modules/mining/Miner"
        $api018 = "Lclub/mymedia/mobileminer/modules/mining/litecoin/LiteCoinMiner"
        $api019 = "Luk/co/wardworks/pocketminer/API/LitecoinPool/LitecoinPoolModal"
        $api020 = "Lcom/wiseplay/web/resources/CoinhiveBlock"
        $api021 = "Lcoinminerandroid/coinminer/cma/coinminerandroid"
        $api023 = "Lcom/minergate/miner/Miner"
        $api024 = "Lcom/minergate/miner/services/MinerService"
        $api025 = "startMiner"
        




	condition:
		androguard.permission(/android.permission.INTERNET/) and 
		((any of ($id*)) or
        (any of ($js*)) or 
        (any of ($lib*)) or
        (any of ($api*)))
		
}
